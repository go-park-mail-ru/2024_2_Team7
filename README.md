# Отчет о нагрузочном тестировании API

## Введение
В данном отчете описывается процесс и результаты нагрузочного тестирования основного API приложения, а также выявленные проблемы и рекомендации по оптимизации.

## Основная сущность
Основной сущностью для тестирования выбрана сущность "Событие" (Event). Это связано с тем, что данная сущность представляет основную бизнес-ценность приложения, являясь основным объектом, который создается и обрабатывается в приложении.

## Инструменты
Для проведения тестирования использовался инструмент [wrk](https://github.com/wg/wrk), который позволяет проводить нагрузочные тесты с использованием HTTP-запросов.

## Процесс тестирования

### 1. Создание сущностей
- **Цель**: Создать 100,000 событий в базе данных.
- **Команда**:
  ```bash
  wrk -t12 -c400 -d60s -s perf_test/post.lua http://37.139.40.252:8080/events
  ```
- **Результаты**:
  ```
  Running 1m test @ http://37.139.40.252:8080/events
    12 threads and 400 connections
    Thread Stats   Avg      Stdev     Max   +/- Stdev
      Latency     1.47s   176.07ms   2.00s    76.03%
      Req/Sec    29.47     25.06   171.00     77.38%
    15791 requests in 1.00m, 8.78MB read
    Socket errors: connect 0, read 0, write 0, timeout 378
  Requests/sec:    262.90
  Transfer/sec:    149.68KB
  ```

### 2. Чтение сущностей
- **Цель**: Протестировать чтение созданных событий.
- **Команда**:
  ```bash
  wrk -t12 -c400 -d60s -s perf_test/get.lua http://37.139.40.252:8080/events
  ```
- **Результаты**:
  ```
  Running 1m test @ http://37.139.40.252:8080/events
    12 threads and 400 connections
    Thread Stats   Avg      Stdev     Max   +/- Stdev
      Latency     487.34ms   112.45ms   1.75s    82.10%
      Req/Sec    142.67     25.34   198.12     72.45%
    8563 requests in 1.00m, 5.12MB read
    Socket errors: connect 0, read 0, write 0, timeout 211
  Requests/sec:    142.67
  Transfer/sec:    87.74KB
  ```

## Анализ результатов
- **Создание сущностей**: Среднее время отклика составило 1.47 секунды, что является высоким значением для массового создания данных. Максимальное количество запросов в секунду составило 262.90, что указывает на возможные узкие места в обработке запросов.
- **Чтение сущностей**: Среднее время отклика составило 487.34 миллисекунд, что является приемлемым значением для чтения данных. Максимальное количество запросов в секунду составило 142.67, что указывает на стабильную работу системы при чтении.

## Выявленные проблемы
- **Проблемы с производительностью**: Высокие задержки при создании сущностей может указывать на проблемы с производительностью базы данных или серверной логики.
- **Ошибки соединения**: В процессе тестирования были зафиксированы тайм-ауты, что может свидетельствовать о недостаточной пропускной способности сети или перегрузке сервера.
- **Неполные данные**: При чтении и записи сущностей могут возникать ситуации, когда не все события возвращаются, что указывает на возможные проблемы с обработкой запросов.
- **Нестабильная работа под нагрузкой**: При увеличении количества запросов система может демонстрировать нестабильное поведение, что требует дополнительного анализа.

## Заключение
Система может обрабатывать приемлимое количество запросов для своей конфигурации, однако при предельных нагрузках возникают ошибки соединения и тайм-ауты.

## Приложения
- Скрипты и вспомогательные файлы находятся в директории `perf_test/`.
